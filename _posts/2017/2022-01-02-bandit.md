---
layout: post
title:	"overthewire - bandit"
date:	2022-01-02 02:02:02
categories:
    - blog
tags:
    - wargame
---

## Level 0

Level nÃ y cÆ¡ báº£n lÃ  connect tá»›i game bandit báº±ng SSH vá»›i host, port, username vÃ  password cho sáºµn

```bash
$ ssh bandit0@bandit.labs.overthewire.org -p 2220
```

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled.png)

## Level 0  â†’ Level 1

Level nÃ y yÃªu cáº§u ta Ä‘á»c file `readme` ******á»Ÿ trong home directory Ä‘á»ƒ cÃ³ password cho level 1.

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%201.png)

Password:

```bash
NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL
```

## Level 1 â†’ Level 2

Level nÃ y tÆ°Æ¡ng tá»± nhÆ° trÃªn, nhÆ°ng bÃ¢y giá» tÃªn file sáº½ lÃ  `-` , ta sáº½ khÃ´ng trá»±c tiáº¿p dÃ¹ng lá»‡nh `cat -` bá»Ÿi vÃ¬ dáº¥u `-` khi ta sá»­ dá»¥ng nÃ³ vá»›i tÆ° cÃ¡ch lÃ  argument cá»§a lá»‡nh cat, thÃ¬ nÃ³ sáº½ cÃ³ liÃªn quan Ä‘áº¿n cÆ¡ cháº¿ STDIN/STDOUT cá»§a Linux. Váº­y Ä‘á»ƒ Ä‘á»c file nÃ y thÃ¬ ta pháº£i nÃªu ra Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i cá»§a nÃ³.

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%202.png)

Password:

```bash
rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi
```

## Level 2 â†’ Level 3

BÃ i nÃ y yÃªu cáº§u ta Ä‘á»c file chá»©a password, mÃ  tÃªn file nÃ y cÃ³ chá»©a dáº¥u cÃ¡ch, náº¿u ta ghi tháº³ng ra vÃ­ dá»¥ nhÆ°

```bash
$ cat spaces in this filename
```

ThÃ¬ á»Ÿ Ä‘Ã¢y `spaces`, `in`, `this`, `filename` sáº½ Ä‘Æ°á»£c cho lÃ  nhá»¯ng argument truyá»n vÃ o lá»‡nh cat, vÃ  há»‡ thá»‘ng sáº½ tÃ¬m nhá»¯ng file cÃ³ tÃªn lÃ  `spaces` `in` `this` vÃ  `filename` Ä‘á»ƒ cat ra, má»¥c Ä‘Ã­ch ta lÃ  cat file cÃ³ khoáº£ng cÃ¡ch, ta sáº½ dÃ¹ng dáº¥u `\` cÃ³ tÃ¡c dá»¥ng escape cÃ¡i character space Ä‘Ã³ Ä‘á»ƒ cÃ³ vai trÃ² trong cÃ¡i string â€œcat spaces in this filenameâ€

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%203.png)

Password:

```bash
aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG
```

## Level 3 â†’ Level 4

Level nÃ y báº£o file password náº±m trong má»™t file bá»‹ áº©n náº±m trong directory lÃ  `inhere`. Äá»ƒ cÃ³ thá»ƒ list file áº©n thÃ¬ ta chá»‰ cáº§n thÃªm flag `-a` vÃ o lá»‡nh `ls`.

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%204.png)

Password:

```bash
2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe
```

## Level 4 â†’ Level 5

Level nÃ y Ä‘á»ƒ file password náº±m giá»¯a má»™t Ä‘á»‘ng file chá»©a nhá»¯ng kÃ­ tá»± Ä‘áº·c biá»‡t, Ä‘á»ƒ phÃ¢n biá»‡t vÃ  nháº­n biáº¿t loáº¡i data chá»©a trong file, ta cÃ³ thá»ƒ dÃ¹ng lá»‡nh `file`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%205.png)

*(á»Ÿ Ä‘Ã¢y vÃ¬ tÃªn cÃ¡c file cÃ³ chá»©a dáº¥u `-` nÃªn Ã¡p dá»¥ng level trÃªn, ta sáº½ dÃ¹ng Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i)*

Tháº¥y file `-file07` cÃ³ data lÃ  ASCII text, quÃ¡ rÃµ rÃ ng rá»“i, ta cat ra thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%206.png)

Password:

```bash
lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR
```

## Level 5 â†’ Level 6

Level nÃ y file password sáº½ náº±m trong má»™t Ä‘á»‘ng file rÃ¡c náº±m trong cÃ¡c thÆ° má»¥c rÃ¡c vÃ  chá»©a trong thÆ° má»¥c `inhere` vÃ  cÃ³ thuá»™c tÃ­nh nhÆ° sau:

- human-readable
- cÃ³ size lÃ  1033 bytes
- khÃ´ng thá»±c thi Ä‘Æ°á»£c

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%207.png)

Äá»ƒ lÃ m viá»‡c nÃ y ta cÃ³ thá»ƒ dÃ¹ng lá»‡nh `find` vÃ  sá»­ dá»¥ng nhá»¯ng flag Ä‘á»ƒ phÃ¢n loáº¡i theo thuá»™c tÃ­nh nhÆ° yÃªu cáº§u Ä‘á» bÃ i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%208.png)

```bash
$ find . -type f -size 1033c -not -executable
./maybehere07/.file2
```

PhÃ¢n tÃ­ch má»™t tÃ­ vá» lá»‡nh trÃªn, `find .` Ä‘á»ƒ tÃ¬m tá»« thÆ° má»¥c hiá»‡n táº¡i lÃ  `inhere`, `-type f` Ä‘á»ƒ phÃ¢n loáº¡i chá»‰ tÃ¬m Ä‘áº¿n `file` chá»© KHÃ”NG PHáº¢I tÃ¬m thÆ° má»¥c, `-size 1033c` Ä‘á»ƒ chá»‰ ra size lÃ  1033 bytes, `-not -executable` thÃ¬ quÃ¡ rÃµ lÃ  khÃ´ng thá»±c thi Ä‘Æ°á»£c. cat ra lÃ  xong

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%209.png)

Password:

```bash
P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU
```

## Level 6 â†’ Level 7

TÆ°Æ¡ng tá»± nhÆ° bÃ i trÃªn, bÃ i nÃ y file password sáº½ cÃ³ thuá»™c tÃ­nh nhÆ° sau:

- sá»Ÿ há»¯u bá»Ÿi user `bandit7`
- sá»Ÿ há»¯u bá»Ÿi group `bandit6`
- cÃ³ size 33 bytes

Ãp dá»¥ng cÃ¡c flag tá»« lá»‡nh `file` nhÆ° level trÃªn, ta sáº½ tÃ¬m file

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2010.png)

Oops, láº§n nÃ y thÃ¬ ta Ä‘Ã£ bá»‹ má»™t Ä‘á»‘ng Permission denied, cÅ©ng dá»… hiá»ƒu táº¡i vÃ¬ chÃºng ta Ä‘ang á»Ÿ user `bandit6` mÃ  cÃ¡c directory Ä‘i qua Ä‘á»ƒ tÃ¬m file password thÃ¬ cÃ³ sá»Ÿ há»¯u bá»Ÿi `bandit7` , tá»›i Ä‘Ã¢y ta cÃ³ thá»ƒ dÃ¹ng 1 trick nhÆ° sau:

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2011.png)

```bash
$ find / -user bandit7 -group bandit6 -size 33c 2>/dev/null
```

Giáº£i thÃ­ch má»™t tÃ­, ta sáº½ chuyá»ƒn hÆ°á»›ng stderr sang /dev/null, Ä‘á»ƒ khÃ´ng pháº£i hiá»‡n ra nhá»¯ng cÃ¡i lá»—i mÃ  gáº·p `Permission denied` , ta muá»‘n nÃ³ hiá»‡n ra path chá»©a password cÆ¡ mÃ  !!

Giá» thÃ¬ Ä‘Æ¡n giáº£n rá»“i, cat file ra thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2012.png)

Password:

```bash
z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S
```

## Level 7 â†’ Level 8

Level nÃ y password náº±m trong 1 file nhÆ° sau

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2013.png)

VÃ  cÃ³ gá»£i Ã½ lÃ , password náº±m káº¿ bÃªn `millionth`

BÃ i nÃ y thÃ¬ Ä‘Æ¡n giáº£n, ta sáº½ dÃ¹ng lá»‡nh `grep`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2014.png)

Lá»‡nh `grep` cÃ³ tÃ¡c dá»¥ng sáº½ in ra cÃ¡i dÃ²ng mÃ  match cÃ¡i pattern ta nháº­p vÃ o lá»‡nh grep

Password:

```bash
TESKZC0XvTetK0S9xNwm25STk5iWrBvP
```

## Level 8 â†’ Level 9

Láº§n nÃ y cÅ©ng nhÆ° level trÃªn, password sáº½ chá»©a trong 1 file mÃ  cÃ¡i dÃ²ng password áº¥y chá»‰ xuáº¥t hiá»‡n Ä‘Ãºng 1 láº§n

VÃ¬ lÃ  xuáº¥t hiá»‡n má»™t láº§n, nÃªn sáº½ cÃ³ nhá»¯ng dÃ²ng xuáº¥t hiá»‡n nhiá»u láº§n, ta sáº½ dÃ¹ng `sort` Ä‘á»ƒ cÃ³ thá»ƒ nhÃ¬n rÃµ hÆ¡n nÃ³ giá»‘ng nhÆ° tháº¿ nÃ o

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2015.png)

Tiáº¿p theo, ta sáº½ dÃ¹ng `uniq` vÃ  vá»›i flag `-u` Ä‘á»ƒ in ra dÃ²ng â€œuniqueâ€ nháº¥t, Ä‘Ãºng vá»›i yÃªu cáº§u Ä‘á» bÃ i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2016.png)

Password:

```bash
EN632PlfYiZbn3PhVK3XOGSlNInNE00t
```

## Level 9 â†’ Level 10

BÃ i nÃ y thÃ¬ password náº±m trong `data.txt` vÃ  trong 1 cÃ¡i strings mÃ  ngÆ°á»i Ä‘á»c Ä‘Æ°á»£c, vÃ  phÃ­a trÆ°á»›c sáº½ lÃ  má»™t vÃ i dáº¥u `=`

Äá»ƒ chá»‰ in ra nhá»¯ng kÃ­ tá»± ngÆ°á»i Ä‘á»c Ä‘Æ°á»£c, ta sáº½ dÃ¹ng lá»‡nh `strings`, vÃ  sau Ä‘Ã³ `grep` tá»›i dáº¥u `=` lÃ  tÃ¬m Ä‘Æ°á»£c password theo Ä‘Ãºng yÃªu cáº§u Ä‘á» bÃ i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2017.png)

Password:

```bash
G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s
```

## Level 10 â†’ Level 11

Password láº§n nÃ y sáº½ chá»©a trong file `data.txt`, ná»™i dung cá»§a file nÃ y chá»©a Ä‘oáº¡n bá»‹ mÃ£ hÃ³a báº±ng base64, ta Ä‘Æ¡n giáº£n chá»‰ lÃ  decode nÃ³ ra sá»­ dá»¥ng lá»‡nh `base64` vÃ  flag `-d` (decode) lÃ  Ä‘Æ°á»£c password

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2018.png)

Password:

```bash
6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM
```

## Level 11 â†’ Level 12

Password level nÃ y chá»©a trong file `data.txt` mÃ  toÃ n bá»™ kÃ­ tá»± Ä‘á»u bá»‹ shift 13 kÃ­ tá»±.

Äá»ƒ cÃ³ thá»ƒ shift láº¡i 13 kÃ­ tá»± thÃ¬ ta cÃ³ thá»ƒ dÃ¹ng lá»‡nh `tr` cÃ³ tÃ¡c dá»¥ng translate cÃ¡c kÃ­ tá»±, náº¿u shift theo 13 kÃ­ tá»± thÃ¬ lÃºc nÃ y chá»¯ A sáº½ thÃ nh M vÃ  Z sáº½ thÃ nh N

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2019.png)

```bash
$ cat data.txt | tr 'A-Za-z' 'N-ZA-Mn-za-m'
```

```bash
JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv
```

## Level 12 â†’ Level 13

BÃ i nÃ y cho ta 1 file hexdump vÃ  bá»‹ nÃ©n ráº¥t nhiá»u lá»›p khÃ¡c nhau, ta sáº½ Ä‘i tá»«ng bÆ°á»›c Ä‘á»ƒ lÃ m bÃ i nÃ y.

Äá»ƒ reverse Ä‘Æ°á»£c cÃ¡i data hexdump, ta cÃ³ thá»ƒ dÃ¹ng lá»‡nh `xxd` vÃ  dÃ¹ng flag `-r`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2020.png)

Ta sáº½ truyá»n nÃ³ vÃ o 1 file Ä‘á»ƒ phÃ¢n tÃ­ch tiáº¿p

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2021.png)

`cat` ra thÃ¬ mÃ¬nh cháº£ hiá»ƒu cÃ¡i type data nÃ y lÃ  gÃ¬ cáº£, mÃ¬nh sáº½ tÃ¬m hiá»ƒu báº±ng lá»‡nh `file`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2022.png)

Yes, váº­y lÃ  ta Ä‘Ã£ sang Ä‘áº¿n bÆ°á»›c giáº£i nÃ©n má»™t loáº¡t lá»›p nÃ©n, Ä‘áº§u tiÃªn sáº½ lÃ  `gzip`, giáº£i nÃ©n báº±ng `gzip -d`

Ã€ trÆ°á»›c háº¿t ta pháº£i Ä‘á»•i tÃªn file vá»«a reverse hexdump ra thÃ¬ lá»‡nh `gzip` má»›i hiá»ƒu Ä‘Æ°á»£c Ä‘á»‹nh dáº¡ng file

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2023.png)

Tiáº¿p theo lÃ  `bzip2`, tá»« bÆ°á»›c nay ta chá»‰ cáº§n thÃªm extension cá»§a file vÃ  sau Ä‘Ã³ giáº£i nÃ©n lÃ  cÃ³ thá»ƒ láº¥y Ä‘Æ°á»£c password

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2024.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2025.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2026.png)

Password

```bash
wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw
```

## Level 13 â†’ Level 14

Password láº§n nÃ y náº±m trong `/etc/bandit_pass/bandit14`, vÃ  chá»‰ Ä‘á»c Ä‘Æ°á»£c bá»Ÿi user `bandit14`, Ä‘á» cho ta má»™t SSH key vÃ  báº£o ta log vÃ o level káº¿ tiáº¿p Ä‘á»ƒ cÃ³ user `bandit14` vÃ  Ä‘á»c Ä‘Æ°á»£c file. Váº­y má»¥c Ä‘Ã­ch cá»§a Level nÃ y lÃ  báº£o ta káº¿t ná»‘i SSH thÃ´ng qua key.

HÃ¬nh dáº¡ng cÃ¡i key trÃ´ng nhÆ° tháº¿ nÃ y

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2027.png)

Äá»ƒ káº¿t ná»‘i `ssh` thÃ´ng qua file key nÃ y, ta cÃ³ thá»ƒ dÃ¹ng flag `-i` cá»§a lá»‡nh `ssh` Ä‘á»ƒ cho vÃ o file identity

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2028.png)

```bash
$ ssh bandit14@bandit.labs.overthewire.org -p 2220 -i sshkey.private
```

Connect thÃ nh cÃ´ng, cat file password ra thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2029.png)

Password:

```bash
fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq
```

## Level 14 â†’ Level 15

Password level nÃ y cÃ³ thá»ƒ láº¥y Ä‘Æ°á»£c tá»« viá»‡c submit cÃ¡i password cá»§a level 13 vÃ o port 30000 á»Ÿ [localhost](http://localhost), mÃ¬nh cÃ³ thá»ƒ Ä‘oÃ¡n Ä‘Æ°á»£c cÃ¡i port nÃ y sáº½ Ä‘Æ°á»£c má»Ÿ táº¡i tcp á»Ÿ localhost trÃªn port 30000, ta cÃ³ thá»ƒ dÃ¹ng `nc` Ä‘á»ƒ connect tá»›i vÃ  nháº­p password.

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2030.png)

Password

```bash
jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt
```

## Level 15 â†’ Level 16

Level nÃ y giá»‘ng level trÆ°á»›c, nhÆ°ng láº§n nÃ y Ä‘á» yÃªu cáº§u ta káº¿t ná»‘i tá»›i [localhost](http://localhost) qua port 30001 báº±ng cÃ¡ch dÃ¹ng mÃ£ hÃ³a SSL vÃ  dÃ¹ng password cá»§a level trÆ°á»›c.

Ta sáº½ dÃ¹ng `openssl` vÃ  vá»›i argument `s_client` Ä‘á»ƒ káº¿t ná»‘i SSL. 

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2031.png)

```bash
$ openssl s_client -connect localhost:30001 -ign_eof
```

Sau Ä‘Ã³ nháº­p password cá»§a level trÆ°á»›c lÃ  láº¥y Ä‘Æ°á»£c password cá»§a level tiáº¿p theo

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2032.png)

```bash
JQttfApK4SeyHwDlI9SXGR50qclOAil1
```

## Level 16 â†’ Level 17

Password láº§n nÃ y láº¥y giá»‘ng level trÆ°á»›c, nhÆ°ng sáº½ cÃ³ nhiá»u yÃªu cáº§u hÆ¡n. Äáº§u tiÃªn lÃ  Ä‘á» sáº½ khÃ´ng nÃªu tháº³ng port mÃ  ta sáº½ káº¿t ná»‘i tá»›i mÃ  báº¯t ta scan ra port áº¥y (trong khoáº£ng tá»« 31000 Ä‘áº¿n 32000), chÆ°a háº¿t, ta pháº£i tÃ¬m trong nhá»¯ng port Ä‘ang Ä‘Æ°á»£c listen thÃ¬ cÃ¡i nÃ o cho káº¿t ná»‘i SSL thÃ¬ ta sáº½ connect tá»›i port Ä‘Ã³.

Ta lÃ m thÃ´i, Ä‘áº§u tiÃªn lÃ  scan port nÃ¨, ta sáº½ dÃ¹ng `nmap` vÃ  dÃ¹ng cÃ¡c flag Ä‘á»ƒ dá»… detect ra port

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2033.png)

```bash
$ nmap -sV -p 31000-32000 127.0.0.1
```

Trong Ä‘Ã³:

- **-sV** : liá»‡t kÃª service cá»§a nhá»¯ng port Ä‘ang OPEN
- **-p** : chá»n port trong khoáº£ng

Ta tháº¥y, 31518 vÃ  31790 cÃ³ dá»‹ch vá»¥ SSL, mÃ  cÃ¡i 31518 cÃ³ echo gÃ¬ Ä‘Ã³ giá»‘ng nhá»¯ng dá»‹ch vá»¥ khÃ¡c (theo Ä‘á» thÃ¬ nhá»¯ng port khÃ¡c sáº½ tá»± tráº£ vá» nhá»¯ng gÃ¬ ta nháº­p nÃªn cÃ³ thá»ƒ Ä‘oÃ¡n Ä‘Æ°á»£c cÃ¡i port nÃ y cÅ©ng váº­y), nÃªn ta sáº½ connect tá»›i **31790**

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2034.png)

```bash
$ openssl s_client localhost:31790
```

Connect thÃ nh cÃ´ng, nháº­p password cá»§a level trÆ°á»›c thÃ¬ ta Ä‘Æ°á»£c cÃ¡i key cho level sau

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2035.png)

## Level 17 â†’ Level 18

DÃ¹ng file key cÃ³ Ä‘Æ°á»£c á»Ÿ level trÆ°á»›c Ä‘á»ƒ connect tá»›i Level 17 nÃ y.

á» level nÃ y, ta sáº½ Ä‘Æ°á»£c cho 2 files táº¡i home directory: `passwords.old` vÃ  `[passwords.new](http://passwords.new)`. Password sáº½ náº±m á»Ÿ file `passwords.new` vÃ  lÃ  cÃ¡i dÃ²ng duy nháº¥t thay Ä‘á»•i giá»¯a 2 file trÃªn.

Äá»ƒ tÃ¬m xem dÃ²ng nÃ o bá»‹ thay Ä‘á»•i giá»¯a 2 file má»›i cÅ© nhÆ° nÃ y, ta cÃ³ thá»ƒ dÃ¹ng lá»‡nh `diff` 

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2036.png)

DÃ²ng cÃ³ dáº¥u `<` lÃ  chá»— Ä‘Ã£ bá»‹ thay Ä‘á»•i vÃ  `>` lÃ  dÃ²ng Ä‘Æ°á»£c thay tháº¿ táº¡i file má»›i, cÅ©ng chÃ­nh lÃ  password Ã¡ Ã´ng dÃ .

Password:

```bash
hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg
```

## Level 18 â†’ Level 19

Password láº§n nÃ y chá»©a trong file `readme` táº¡i home, mÃ  cÃ³ ngÆ°á»i chá»‰nh cÃ¡i `.bashrc` cho ta tá»± Ä‘á»™ng log out khi connect tá»›i ssh. NÃ³i má»™t tÃ­ vá» cÃ¡i `.bashrc` thÃ¬ nÃ³ sáº½ chá»©a nhá»¯ng config mÃ  ngÆ°á»i dÃ¹ng muá»‘n config trÃªn bash shell má»—i khi boot há»‡ Ä‘iá»u hÃ nh. Váº­y thÃ¬ ta sáº½ lÃ m gÃ¬ Ä‘á»ƒ bypass Ä‘Æ°á»£c chá»— nÃ y Ä‘Ã¢y ???

NhÆ° Ä‘Ã£ biáº¿t thÃ¬ trÃªn má»—i terminal, ta cÃ³ thá»ƒ chá»©a nhiá»u loáº¡i shell khÃ¡c nhau, ngoÃ i `bash` , thÃ¬ Bourne shell (`sh`) sáº½ Ä‘Æ°á»£c config sáºµn trÃªn má»™t sá»‘ há»‡ Ä‘iá»u hÃ nh.

Lá»‡nh `ssh` cÃ³ má»™t flag lÃ  `-t` , cÃ´ng dá»¥ng cá»§a nÃ³ trÃªn `man` lÃ  nhÆ° nÃ y 

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2037.png)

Äáº¡i khÃ¡i lÃ  nÃ³ sáº½ thay Ä‘á»•i cÃ¡i pseudo-terminal allocation vÃ  execute cÃ¡i program áº¥y, váº­y ta chá»‰ cáº§n thÃªm argument `/bin/sh` lÃ  cÃ³ thá»ƒ connect tá»›i ssh vÃ  dÃ¹ng `sh` mÃ  khÃ´ng pháº£i qua cÃ¡i `bash` vÃ  bá»‹ nÃ³ kick má»™t cÃ¡ch Ä‘ao Ä‘á»›n nhÆ° z

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2038.png)

Password:

```bash
awhqfNnAbc1naukrpqDYcF95h7HoMTrC
```

## Level 19 â†’ Level 20

Level nÃ y cho ta má»™t file `setuid`  tÃªn lÃ  `bandit20-do`, thá»±c thi nÃ³ báº±ng viá»‡c truyá»n vÃ o má»™t argument.

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2039.png)

NhÃ¬n vÃ o tÃªn cá»§a file thÃ¬ ta cÃ³ thá»ƒ hÃ¬nh dung lÃ , khi thá»±c thi file nÃ y, nÃ³ sáº½ cho ta dÃ¹ng nhá»¯ng lá»‡nh vá»›i tÆ° cÃ¡ch lÃ  user `bandit20`. CÃ¹ng test báº±ng viá»‡c cháº¡y `id` nha.

So sÃ¡nh khi ta cháº¡y lá»‡nh `id` trÃªn user `bandit19` vÃ  trÃªn file `setuid` nha

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2040.png)

ÄÃ³ Ä‘Ã³, cÃ¡c báº¡n tháº¥y nÃ³ Ä‘Ã£ ra má»™t euid lÃ  `bandit20` Ã¡, náº¿u level cho láº±ng nháº±ng nhÆ° nÃ y thÃ¬ chá»‰ cÃ³ thá»ƒ lÃ  cÃ¡i file password chá»‰ Ä‘Æ°á»£c Ä‘á»c bá»Ÿi `bandit20`, cÃ¹ng thá»­ nha

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2041.png)

RÃµ rÃ ng, password chá»‰ Ä‘Æ°á»£c Ä‘á»c bá»Ÿi `bandit20`, dÃ¹ng cÃ¡i file kia Ä‘á»ƒ Ä‘á»c nÃ o

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2042.png)

```bash
VxCazJaVykI6W36BkBU0mJTCM8rR95XT
```

## Level 20 â†’ Level 21

Láº§n nÃ y cho má»™t file `setuid` nhÆ° level trÃªn, vÃ  cÃ´ng dá»¥ng cá»§a nÃ³ lÃ  táº¡o má»™t káº¿t ná»‘i Ä‘áº¿n `[localhost](http://localhost)` vÃ  á»Ÿ port mÃ  mÃ¬nh sáº½ truyá»n vÃ o khi thá»±c thi file `setuid` vá»«a nÃªu, sau khi káº¿t ná»‘i nÃ³ sáº½ Ä‘á»c má»™t dÃ²ng text, náº¿u nÃ³ lÃ  password cá»§a level trÆ°á»›c thÃ¬ sáº½ cho ta password Ä‘á»ƒ Ä‘áº¿n level tiáº¿p theo.

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2043.png)

Váº­y thÃ¬ yÃªu cáº§u láº§n nÃ y Ä‘Æ¡n giáº£n rá»“i, nÃ³ muá»‘n káº¿t ná»‘i vÃ  giao tiáº¿p vá»›i `[localhost](http://localhost)` lÃ m mÃ¬nh nhá»› Ä‘áº¿n viá»‡c dÃ¹ng `nc` vÃ  giao tiáº¿p vá»›i nhau.

Äáº§u tiÃªn ta sáº½ táº¡o má»™t listener vá»›i port báº¥t kÃ¬ trÃªn `[localhost](http://localhost)` dÃ¹ng `nc`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2044.png)

```bash
$ nc -lnvp 4444
```

Sau Ä‘Ã³ dÃ¹ng file `setuid` vÃ  truyá»n vÃ o port mÃ  mÃ¬nh cho láº¯ng nghe á»Ÿ `nc`, á»Ÿ Ä‘Ã¢y lÃ  **4444**

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2045.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2046.png)

Ta tháº¥y listener Ä‘Ã£ nháº­n Ä‘Æ°á»£c káº¿t ná»‘i tá»« port **40016.**

Giá» chá»‰ cáº§n truyá»n password cá»§a level trÆ°á»›c lÃ  ra pass tiáº¿p theo 

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2047.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2048.png)

```bash
NvEJF7oVjkddltPSrdKEFOllh9V1IBcq
```

## Level 21 â†’ Level 22

Level nÃ y cÃ³ description nhÆ° sau, tháº­t ra lÃºc Ä‘áº§u Ä‘á»c mÃ¬nh cÅ©ng cháº£ hiá»ƒu gÃ¬

- *â€œA program is running automatically at regular intervals from **cron**, the time-based job scheduler. Look in **/etc/cron.d/** for the configuration and see what command is being executed.â€*

LÃºc nÃ y mÃ¬nh má»›i Ä‘i tÃ¬m hiá»ƒu thá»­ `cron` lÃ  cÃ¡i gÃ¬

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2049.png)

Okay, qua máº¥y dÃ²ng trÃªn lÃ  mÃ¬nh cÅ©ng hiá»ƒu sÆ¡ sÆ¡ rá»“i, giá» thÃ¬ theo Ä‘á» bÃ i mÃ  mÃ¬nh sáº½ xem trong `/etc/cron.d/` cÃ³ gÃ¬    

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2050.png)

CÃ³ nhiá»u file nÃ¨, mÃ  mÃ¬nh Ä‘ang quan tÃ¢m cÃ¡i `bandit22` táº¡i nÃ³ lÃ  level tiáº¿p theo nÃªn `cat` ra Ä‘á»ƒ xem sao

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2051.png)

Okay, nhÆ° lÃºc tÃ¬m hiá»ƒu thÃ¬ nÃ³ dÃ¹ng Ä‘á»ƒ cháº¡y cÃ¡c tÃ¡c vá»¥ ngáº§m gÃ¬ gÃ¬ Ä‘áº¥y, ráº¥t cÃ³ thá»ƒ nhá»¯ng dÃ²ng lá»‡nh trong file nÃ y Ä‘Ã£ Ä‘Æ°á»£c cháº¡y lÃºc boot, mÃ¬nh sáº½ Ä‘i tÃ¬m hiá»ƒu cÃ¡i `@reboot` hay cÃ¡i `* * * * *` kia lÃ  gÃ¬

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2052.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2053.png)

Okay váº­y lÃ  mÃ¬nh Ä‘Ã£ há»c thÃªm Ä‘Æ°á»£c cÃ¡i `crontab` rá»“i, giá» quay láº¡i bÃ i thÃ´i, lÃºc boot thÃ¬ há»‡ thá»‘ng sáº½ truyá»n `usr/bin/cronjob_bandit22.sh` sang /dev/null, cÃ¹ng xem file `sh` nÃ y cÃ³ gÃ¬

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2054.png)

NÃ³ set quyá»n 644 cho file `/tmp/<gÃ¬ gÃ¬ Ä‘áº¥y>` vÃ  cat pass cá»§a bandit22 vÃ´ file trÃªn, 644 lÃ  lá»‡nh mÃ  chá»§ sá»Ÿ há»¯u cÃ³ quyá»n Ä‘á»c vÃ  ghi cÃ²n user hay group khÃ¡c chá»‰ Ä‘Æ°á»£c Ä‘á»c, váº­y chá»‰ cáº§n Ä‘á»c cÃ¡i file `/tmp/<gÃ¬ gÃ¬ Ä‘áº¥y>` lÃ  cÃ³ pass rÃ¹i 

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2055.png)

```bash
WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff
```

## Level 22 â†’ Level 23

TÆ°Æ¡ng tá»± level trÃªn, ta láº¡i pháº£i Ä‘i Ä‘á»c `/etc/cron.d` vÃ  phÃ¢n tÃ­ch, cÃ¹ng lÃ m nÃ o, láº§n nÃ y sáº½ lÃ  `/cronjob_bandit2`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2056.png)

KhÃ´ng khÃ¡c gÃ¬ level trÆ°á»›c, phÃ¢n tÃ­ch tháº³ng bash script thÃ´i ğŸ˜

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2057.png)

```bash
#!/bin/bash

myname=$(whoami)
mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)

echo "Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget"

cat /etc/bandit_pass/$myname > /tmp/$mytarget
```

PhÃ¢n tÃ­ch má»™t tÃ­ cÃ¡i bash script nÃ y: 

- Äáº§u tiÃªn sáº½ set biáº¿n `myname` thÃ nh output cá»§a lá»‡nh `whoami`
- Set biáº¿n `target` tá»« viá»‡c echo má»™t string cÃ³ chá»©a biáº¿n `myname`, md5  nÃ³ vÃ  cut string tá»« lá»‡nh `md5sum` Ä‘áº¿n dáº¥u cÃ¡ch Ä‘áº§u tiÃªn.
- In ra â€œCopying â€¦â€
- VÃ  truyá»n output cá»§a password Ä‘áº¿n `/tmp/$mytarget`

Password ta cáº§n tÃ¬m lÃ  cá»§a `bandit23`, dá»±a vÃ o bash script trÃªn, ta sáº½ tá»± thá»±c thi lá»‡nh nhÆ° file Ä‘áº¥y Ä‘á»ƒ láº¥y Ä‘Æ°á»£c tÃªn file chá»©a password cá»§a `bandit23`

Má»—i khi connect tá»›i level nÃ o Ä‘Ã³ vÃ  `whoami` thÃ¬ tÃªn user sáº½ cÃ³ Ä‘á»‹nh dáº¡ng nhÆ° kiá»ƒu `bandit23`, nÃªn biáº¿n `myname` ta sáº½ cho lÃ  ***â€œbandit23â€**,* giá» chá»‰ cáº§n láº¥y Ä‘Æ°á»£c output cá»§a `$mytarget` lÃ  Ä‘Æ°á»£c

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2058.png)

```bash
8ca319486bfbbc3663ea0fbe81326349
```

Okay, Ä‘á»c `/tmp/8ca319486bfbbc3663ea0fbe81326349` thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2059.png)

Password:

```bash
QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G
```

## Level 23 â†’ Level 24

Tiáº¿p tá»¥c má»™t bÃ i vá» `crontab`, nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn thÃ¬ nhÆ° nhau thÃ´i. NhÆ° thÆ°á»ng lá»‡, ta sáº½ Ä‘á»c file `/usr/bin/cronjob_bandit24.sh`

```bash
#!/bin/bash

myname=$(whoami)

cd /var/spool/$myname/foo
echo "Executing and deleting all scripts in /var/spool/$myname/foo:"
for i in * .*;
do
    if [ "$i" != "." -a "$i" != ".." ];
    then
        echo "Handling $i"
        owner="$(stat --format "%U" ./$i)"
        if [ "${owner}" = "bandit23" ]; then
            timeout -s 9 60 ./$i
        fi
        rm -f ./$i
    fi
done
```

Äá»c hiá»ƒu tÃ­ vá» script nÃ y:

- Äáº§u tiÃªn nÃ³ sáº½ gÃ¡n output cá»§a lá»‡nh `whoami` vÃ o biáº¿n `myname`
- Sau Ä‘Ã³ `cd` Ä‘áº¿n `/var/spool/$myname/foo`
- Sau Ä‘Ã³ in ra dÃ²ng nhÆ° trong script
- Duyá»‡t táº¥t cáº£ cÃ¡c file trong thÆ° má»¥c, vÃ  náº¿u sá»Ÿ há»¯u cá»§a file lÃ  `bandit23` thÃ¬ sáº½ thá»±c thi file sau khi timeout 90 giÃ¢y
- XÃ³a file

Váº­y thÃ¬ nhiá»‡m vá»¥ cá»§a ta sáº½ lÃ  viáº¿t má»™t file bash script vÃ  cho chá»©a trong `/var/spool/$myname/foo` mÃ  á»Ÿ Ä‘Ã¢y myname sáº½ lÃ  bandit24 Ä‘á»ƒ chÆ°Æ¡ng trÃ¬nh thá»±c thi.

Ná»™i dung cá»§a file script thÃ¬ sáº½ lÃ  cÃ¢u lá»‡nh truyá»n password cá»§a `bandit24` trong `/etc/bandit_pass/bandit24` (format nÃ y thÃ¬ ta cÃ³ thá»ƒ tá»± suy tá»« nhá»¯ng level trÆ°á»›c), truyá»n sang má»™t file nÃ o Ä‘Ã³ bÃªn ngoÃ i Ä‘á»ƒ ta Ä‘á»c. Äá» cÃ³ gá»£i Ã½ ta táº¡o má»™t thÆ° má»¥c bÃªn ngoÃ i Ä‘á»ƒ dá»… quáº£n lÃ½, mÃ¬nh sáº½ táº¡o trong `/tmp`  

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2060.png)

Sau Ä‘Ã³, mÃ¬nh sáº½ viáº¿t má»™t bash script vá»›i ná»™i dung sau

```bash
#!/bin/bash
cat /etc/bandit_pass/bandit24 > /tmp/tmp_ne/pw
```

Má»™t script Ä‘Æ¡n giáº£n nhÆ° mÃ¬nh Ä‘Ã£ nÃ³i Ã½ tÆ°á»Ÿng tá»« trÆ°á»›c, truyá»n tháº³ng pass cá»§a bandit24 vÃ o `/tmp/tmp_ne/pw`, táº¥t nhiÃªn trÆ°á»›c Ä‘Ã³ mÃ¬nh Ä‘Ã£ cáº¥p quyá»n `777` cho directory `tmp_ne` Ä‘á»ƒ `bandit24` sau khi thá»±c thi file thÃ¬ cÃ³ thá»ƒ truyá»n Ä‘Æ°á»£c mÃ  khÃ´ng bá»‹ Permission Denied. Äá»«ng quÃªn cáº¥p `777` cho cáº£ file bash script luÃ´n.

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2061.png)

Sau Ä‘Ã³ chá»‰ cáº§n copy qua `/var/spool/bandit24/foo` vÃ  Ä‘á»£i 60 giÃ¢y rá»“i check file `pw`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2062.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2063.png)

Password:

```bash
VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar
```

## Level 24 â†’ Level 25

á» level nÃ y, Ä‘á» báº£o chÃºng ta cÃ³ má»™t daemon Ä‘ang láº¯ng nghe á»Ÿ port **30002** vÃ  báº£o náº¿u ta Ä‘Æ°a nÃ³ pass cá»§a bandit24 vÃ  4 digit pincode, nÃ³ sáº½ tráº£ cho ta password cá»§a bandit25. Thá»­ xem káº¿t ná»‘i nhÆ° nÃ o Ä‘Ã£

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2064.png)

Okay váº­y ta cáº§n pháº£i viáº¿t má»™t cÃ¡i script Ä‘á»ƒ bruteforce nhÃ¨ nháº¹ rá»“i.

VÃ¬ á»Ÿ **30002** khi ta gÃµ sai sáº½ báº£o ta gÃµ tiáº¿p chá»© khÃ´ng ngáº¯t káº¿t ná»‘i, nÃªn ta cÃ³ thá»ƒ truyá»n má»™t file chá»©a sáºµn password vÃ  nhá»¯ng sá»‘ pincode tá»« 0000 Ä‘áº¿n 9999 Ä‘á»ƒ bruteforce tháº³ng, file Ä‘áº¥y cÃ³ thá»ƒ táº¡o tá»« bash script nhÆ° sau

```bash
#!/bin/bash
for i in {0..9999}
do
			echo VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar $i >> no.txt
done
```

Sau Ä‘Ã³ cháº¡y nc Ä‘áº¿n vÃ  truyá»n file `no.txt` 

```bash
$ nc localhost 30002 < no.txt
```

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2065.png)

Password:

```bash
p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d
```

## Level 25 â†’ Level 26

Äá» láº§n nÃ y báº£o ta vÃ o bandit26 ráº¥t dá»… nhÆ°ng shell cá»§a bandit26 khÃ´ng pháº£i lÃ  ***/bin/bash*** vÃ  báº£o ta tÃ¬m hiá»ƒu vá» nÃ³ vÃ  tÃ¬m cÃ¡ch break out nÃ³, giá» ta xem trong bandit25 cÃ³ gÃ¬ Ä‘Ã£

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2066.png)

Má»™t file sshkey, ta sáº½ dÃ¹ng key nÃ y Ä‘á»ƒ connect tá»›i bandit26

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2067.png)

Vá»«a vÃ o thÃ¬ level Ä‘Ã£ Ä‘Ã¡ ta ra ngoÃ i rá»“i, lÃºc nÃ y thÃ¬ mÃ¬nh cÅ©ng chÆ°a hiá»ƒu gÃ¬ háº¿t, nhÆ°ng theo yÃªu cáº§u cá»§a Ä‘á» thÃ¬ Ä‘á»ƒ xem thá»­ `bandit26` dÃ¹ng shell gÃ¬, quay láº¡i vá»›i `bandit25` vÃ  Ä‘á»c ***/etc/passwd*** 

```bash
$ cat /etc/passwd | grep bandit26
```

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2068.png)

Oops, ***/usr/bin/showtext*** lÃ  cÃ¡i gÃ¬ kia :)), ta Ä‘i tÃ¬m hiá»ƒu nÃ³ thá»­

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2069.png)

Má»™t shell script cÃ³ ná»™i dung nhÆ° trÃªn, ta sáº½ phÃ¢n tÃ­ch nÃ³

- DÃ²ng Ä‘áº§u lÃ  shebang nhÆ° thÆ°á»ng
- DÃ²ng tiáº¿p theo lÃ  set cÃ¡i terminal emulation lÃ  `linux`
- Tiáº¿p theo lÃ  thá»±c thi lá»‡nh `more ~/text.txt`
- Cuá»‘i cÃ¹ng lÃ  exit

Máº¥y lá»‡nh khÃ¡c thÃ¬ ta cÃ³ thá»ƒ hÃ¬nh dung hoáº·c Ä‘oÃ¡n Ä‘Æ°á»£c Ã½ nghÄ©a, nhÆ°ng cÃ²n `more` lÃ  gÃ¬, theo `man`, `more` lÃ :

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2070.png)

Äáº¡i khÃ¡i lÃ  nÃ³ sáº½ hiá»ƒn thá»‹ ná»™i dung cá»§a file trÃªn giao diá»‡n dÃ²ng lá»‡nh theo trang.

Äá»ƒ vÃ o giao diá»‡n cá»§a `more`, ta pháº£i Ä‘á»•i láº¡i size cá»§a cá»­a sá»• terminal sao cho khÃ´ng chá»©a háº¿t ná»™i dung cá»§a file Ä‘Æ°á»£c `more`, á»Ÿ Ä‘Ã¢y thÃ¬ ta sáº½ chá»‰nh sao cho chá»¯ bandit lÃ m tá»« `figlet` kia nhá» hÆ¡n cá»­a sá»• nhÆ° sau thÃ¬ khi káº¿t ná»‘i sáº½ vÃ´ Ä‘Æ°á»£c giao diá»‡n cá»§a `more`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2071.png)

Sau Ä‘Ã³ nháº¥n `h` sáº½ vÃ o Ä‘Æ°á»£c giao diá»‡n ***help*** cá»§a `more`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2072.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2073.png)

Nhá»¯ng lá»‡nh khÃ¡c thÃ¬ trÃ´ng cÃ³ váº» chÆ°a cÃ³ Ã½ tÆ°á»Ÿng pháº£i lÃ m gÃ¬ vá»›i nÃ³, nhÆ°ng vá»›i `v` thÃ¬ sáº½ cháº¡y `/usr/bin/vi` lÃ  text editor `vim` mÃ  mÃ¬nh yÃªu thÃ­ch dÃ¹ng bá»Ÿi nÃ³ cÃ³ command mode ráº¥t máº¡nh, vÃ´ nÃ³ thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2074.png)

VÃ o vi thÃ nh cÃ´ng, giá» ta cÃ³ thá»ƒ vÃ o command mode Ä‘á»ƒ Ä‘á»c password nÃ o, dÃ¹ng lá»‡nh `:e /etc/bandit_pass/bandit26` Ä‘á»ƒ Ä‘á»c pass cá»§a 26 nÃ o

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2075.png)

Password:

```bash
c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1
```

## Level 26 â†’ Level 27

Description nÃ³ nhÆ° sau

```bash
Good job getting a shell! Now hurry and grab the password for bandit27!
```

Uáº§y, váº­y thÃ¬ á»Ÿ level trÆ°á»›c mÃ¬nh chá»‰ má»›i Ä‘á»c file pass tá»« vim thÃ´i, mÃ¬nh cáº§n láº¥y Ä‘Æ°á»£c shell cÆ¡, mÃ  bÆ°á»›c nÃ y thÃ¬ cÅ©ng Ä‘Æ¡n giáº£n, quay láº¡i tá»« chá»— vÃ o Ä‘Æ°á»£c vim nha, thay vÃ¬ má»Ÿ file pass thÃ¬ ta sáº½ set láº¡i biáº¿n SHELL thÃ nh ***/bin/bash*** lÃ  cÃ³ thá»ƒ dÃ¹ng bash mÃ  khÃ´ng pháº£i ***showtext*** ná»¯a

```bash
:set shell=/bin/bash
```

Sau Ä‘Ã³ thá»±c thi `:shell` lÃ  cÃ³ thá»ƒ vÃ´ Ä‘Æ°á»£c ***/bin/bash*** 

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2076.png)

Má»™t file `bandit27-do` ráº¥t giá»‘ng vá»›i file setuid giá»‘ng level á»Ÿ phÃ­a trÃªn trÃªn, kiá»ƒm tra thÃ¬ Ä‘Ãºng nhÆ° váº­y

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2077.png)

DÃ¹ng nÃ³ Ä‘á»ƒ Ä‘á»c pass cá»§a `bandit27` thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2078.png)

Password:

```bash
YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS
```

## Level 27 â†’ Level 28

Láº§n nÃ y level cho ta má»™t link git repo cÃ³ chá»©a password, báº£o ta clone vá» vÃ  tÃ¬m password.

MÃ¬nh clone táº¡i home thÃ¬ khÃ´ng cÃ³ quyá»n nÃªn mÃ¬nh sáº½ clone trong `tmp`

```bash
$ git clone ssh://bandit27-git@localhost/home/bandit27-git/repo
```

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2079.png)

Khi mÃ¬nh dÃ¹ng lá»‡nh nÃ y, output tráº£ vá» ráº±ng khÃ´ng káº¿t ná»‘i Ä‘Æ°á»£c do dÃ¹ng Ä‘ang cá»‘ gáº¯ng káº¿t ná»‘i tá»›i port 22 máº·c Ä‘á»‹nh cá»§a `ssh`, mÃ  ta cáº§n connect táº¡i port 2220, nÃªn pháº£i thÃªm táº¡i url clone lÃ 

```bash
ssh://bandit27-git@localhost:2220/home/bandit27-git/repo
```

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2080.png)

ThÃ nh cÃ´ng clone `repo` vá» rá»“i, Ä‘á»c README lÃ  cÃ³ file password

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2081.png)

Password:

```bash
AVanL161y9rsbcJIsFHuw35rjaOM19nR
```

## Level 28 â†’ Level 29

Level láº§n nÃ y giá»‘ng trÆ°á»›c, ta sáº½ clone cÃ¡i repo vá» vÃ  xem trong README thá»­ nha

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2082.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2083.png)

QuÃ o, cÃ³ váº» password Ä‘Ã£ bá»‹ READACTED, kiá»ƒm tra trong log thá»­

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2084.png)

Tháº¥y cÃ³ commit táº¡i master Ä‘á»ƒ ***â€œfix info leakâ€*** cÃ³ thá»ƒ lÃ  chá»‰nh cÃ¡i password kia, ta sáº½ diff 2 cÃ¡i commit gáº§n nháº¥t Ä‘á»ƒ xem sá»± thay Ä‘á»•i nhÆ° tháº¿ nÃ o

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2085.png)

á» dá», váº­y lÃ  suy Ä‘oÃ¡n cá»§a ta Ä‘Ã£ Ä‘Ãºng, láº¥y pass thÃ´i

Password:

```bash
tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S
```

## Level 29 â†’ Level 30

Tiáº¿p tá»¥c lÃ  má»™t bÃ i vá» `git` , lÃ m nhá»¯ng bÆ°á»›c nhÆ° bÃ i trÆ°á»›c thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2086.png)

Kiá»ƒm tra thá»­ commit log

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2087.png)

Oops, Ä‘á»c message thÃ¬ cÃ³ thá»ƒ Ä‘oÃ¡n ta khÃ´ng láº¥y Ä‘Æ°á»£c gÃ¬ tá»« Ä‘Ã¢y cáº£, báº¿ táº¯c Ã ?? KhÃ´ng, Ä‘Ã¢y chá»‰ lÃ  commit log tá»« branch master, thá»­ xem cÃ²n branch khÃ¡c khÃ´ng

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2088.png)

QuÃ o, má»™t Ä‘á»‘ng luÃ´n, thá»­ checkout tá»›i láº§n lÆ°á»£t tá»«ng cÃ¡i vÃ  xem thá»­ cÃ³ commit nÃ o chá»©a pass khÃ´ng, Ä‘áº§u tiÃªn lÃ  vÃ o `remotes/origin/dev` nha

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2089.png)

Kiá»ƒm tra commit log

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2090.png)

Okay, ta tháº¥y khÃ¡ nhiá»u commit, thá»­ xem 2 cÃ¡i gáº§n nháº¥t

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2091.png)

Yes, Ä‘Ãºng Ã½ luÃ´n, láº¥y pass thÃ´i

Password:

```bash
xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS
```

## Level 30 â†’ Level 31

Tiáº¿p tá»¥c láº¡i lÃ  má»™t bÃ i vá» `git`, lÃ m nhÆ° nhá»¯ng bÆ°á»›c ban Ä‘áº§u cá»§a level trÃªn, check `git log` vÃ  check cÃ¡c branch khÃ¡c.

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2092.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2093.png)

Cháº£ cÃ³ gÃ¬ Ä‘áº·c biá»‡t cáº£, váº­y biáº¿t Ä‘i tÃ¬m pass á»Ÿ Ä‘Ã¢u Ä‘Ã¢y?? Hmmm

Sau má»™t há»“i tra cá»©u cÃ¡c thá»©, Ä‘á»c láº¡i `man` vÃ  thá»­, thÃ¬ mÃ¬nh phÃ¡t hiá»‡n ra chá»©c nÄƒng `tag` trong git.

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2094.png)

ChÆ°a rÃµ rÃ ng nhá»‰, search Google thÃ´i

***â€œTag lÃ  chá»©c nÄƒng Ä‘áº·t tÃªn má»™t cÃ¡ch Ä‘Æ¡n giáº£n cá»§a Git, nÃ³ cho phÃ©p ta xÃ¡c Ä‘á»‹nh má»™t cÃ¡ch rÃµ rÃ ng cÃ¡c phiÃªn báº£n mÃ£ nguá»“n (code) cá»§a dá»± Ã¡n. Ta cÃ³ thá»ƒ coi tag nhÆ° má»™t branch khÃ´ng thay Ä‘á»•i Ä‘Æ°á»£c. Má»™t khi nÃ³ Ä‘Æ°á»£c táº¡o (gáº¯n vá»›i 1 commit cá»¥ thá»ƒ) thÃ¬ ta khÃ´ng thá»ƒ thay Ä‘á»•i lá»‹ch sá»­ commit áº¥y Ä‘Æ°á»£c ná»¯a.â€***

Yes, há»c thÃªm má»™t chá»©c nÄƒng má»›i cá»§a git rá»“i, dÃ¹ng nÃ³ thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2095.png)

CÃ³ má»™t tag `secret`, show nÃ³ ra thÃ¬ Ä‘Æ°á»£c password quÃ¡ Ä‘áº¹p

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2096.png)

Password:

```bash
OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt
```

## Level 31 â†’ Level 32

Láº I lÃ  má»™t bÃ i vá» `git`, lÃ m nhÆ° nÃ£y giá» thÃ´i nÃ o kkk. Äá»c file README thÃ¬ cÃ³ ná»™i dung nhÆ° sau

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2097.png)

NÃ³ báº£o ta láº§n náº£y pháº£i push lÃªn remote repo cÃ¡i file key.txt vá»›i ná»™i dung ***â€œMay I come in?â€*** tá»« branch master, váº­y ta sáº½ lÃ m thÃ´i.

Äáº§u tiÃªn lÃ  táº¡o file `key.txt` vá»›i ná»™i dung nhÆ° yÃªu cáº§u

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2098.png)

Hiá»‡n táº¡i Ä‘Ã£ á»Ÿ branch `master` nÃªn ta khÃ´ng cáº§n checkout sang chá»— khÃ¡c, stage vÃ  commit lÃªn thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%2099.png)

á»¦a gÃ¬ z, `.gitignore` Ä‘Ã£ cháº·n file cá»§a ta rá»“i, Ä‘á»c thá»­ nÃ³ nÃ¨

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20100.png)

ChÃ­nh xÃ¡c, nÃ³ ignore nhá»¯ng file cÃ³ extension `txt`, váº­y ta cáº§n thÃªm flag `-f` (force) Ä‘á»ƒ â€œÃ©pâ€ git add vÃ o vÃ¹ng staging

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20101.png)

Add Ä‘Æ°á»£c rá»“i nÃ¨, commit rá»“i push thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20102.png)

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20103.png)

Password:

```bash
rmCBvG56y58BXzv98yZGdO7ATVL5dW8y
```

## Level 32 â†’ Level 33

Description láº§n nÃ y ráº¥t ngáº¯n gá»n

```bash
After all this git stuff its time for another escape. Good luck!
```

LÃ  má»™t cÃ¡i ***jail*** sao? Connect thá»­

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20104.png)

ChÃ­nh xÃ¡c luÃ´n, nhá»¯ng bÃ i jail nhÆ° nÃ y thÃ¬ mÃ¬nh pháº£i thoÃ¡t Ä‘Æ°á»£c cÃ¡i xÃ m xÃ m cá»§a challenge vÃ  thá»±c thi lá»‡nh tÃ¹y thÃ­ch, á»Ÿ Ä‘Ã¢y lÃ  nÃ³ sáº½ tá»± Ä‘á»™ng VIáº¾T HOA nhá»¯ng tá»« mÃ  ta nháº­p vÃ o.

Vá»›i bÃ i nÃ y thÃ¬ mÃ¬nh Ä‘Ã£ tá»«ng gáº·p á»Ÿ má»™t event CTF rá»“i (cháº¯c bÃ i Ä‘Ã³ láº¥y Ã½ tÆ°á»Ÿng tá»« Ä‘Ã¢y), thÃ¬ tháº±ng terminal cá»§a Linux sáº½ define sáºµn má»™t vÃ i variable, mÃ  nhá»¯ng variable Ä‘Ã³ define vá»›i tÃªn Ä‘Æ°á»£c viáº¿t hoa táº¥t cáº£ luÃ´n, nÃ³ cÃ³ thá»ƒ chá»©a nhá»¯ng config nÃ o Ä‘Ã³ cá»§a terminal hoáº·c nhá»¯ng config cá»§a linux. Má»™t vÃ i vÃ­ dá»¥:

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20105.png)

Test thá»­ trÃªn challenge nÃ¨

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20106.png)

Hiá»ƒu Ã½ tÆ°á»Ÿng rá»“i, ngoÃ i nhá»¯ng biáº¿n khá»Ÿi táº¡o sáºµn mÃ  mÃ¬nh Ä‘Ã£ show á»Ÿ trÃªn, ta cÃ²n cÃ³ `$0` .

`$0` sáº½ lÃ  tÃªn cá»§a chÆ°Æ¡ng trÃ¬nh mÃ  cá»¥ thá»ƒ lÃ  cÃ¡i shell, cháº¡y thá»­ trÃªn mÃ¡y thÆ°á»ng

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20107.png)

á» Ä‘Ã¢y mÃ¬nh dÃ¹ng shell `zsh` nÃªn output ra shell `zsh`, khi ta dÃ¹ng lá»‡nh `file` thÃ¬ tháº¥y nÃ³ lÃ  má»™t file ELF thá»±c thi Ä‘Æ°á»£c, váº­y quay láº¡i challenge vÃ  cho cháº¡y `$0` thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20108.png)

HÃ­ hÃ­ xong gÃ²i nha, Ä‘á»c pass thÃ´i

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20109.png)

Password:

```bash
odHo63fHiFqcWWJG9rLiLDtPm45KzUKy
```

NgoÃ i lá» tÃ­, lÃºc mÃ¬nh lÃ m tá»›i gáº§n cuá»‘i thÃ¬ báº¡n mÃ¬nh cÃ³ há»i, sao ta khÃ´ng xÃ i $SHELL luÃ´n, thÃ¬ ta thá»­ dÃ¹ng $SHELL nha

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20110.png)

NÃ³ Ä‘Ã£ Ä‘Æ°a mÃ¬nh vÃ´ jail láº¡i, váº­y lÃ  cÃ¡i biáº¿n SHELL nÃ y Ä‘Ã£ thá»±c thi má»™t shell khÃ¡c, cá»¥ thá»ƒ lÃ  cÃ¡i nÃ y

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20111.png)

CÃ²n `$0` cá»§a nÃ³ lÃ  `sh`

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20112.png)

## Level 34

![Untitled](bandit%2097d0d45daa614ecdb5e6053f78d83139/Untitled%20113.png)